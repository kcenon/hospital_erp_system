apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: hospital-erp-system

resources:
  - ../../base

patches:
  - path: patches/production-replicas.yaml
  - path: patches/production-resources.yaml
  - path: patches/production-hpa.yaml
  - path: patches/production-affinity.yaml

configMapGenerator:
  - name: backend-config
    behavior: merge
    literals:
      - NODE_ENV=production
      - LOG_LEVEL=warn
      - CORS_ORIGIN=https://hospital.example.com

  - name: frontend-config
    behavior: merge
    literals:
      - NEXT_PUBLIC_API_URL=https://api.hospital.example.com
      - NEXT_PUBLIC_APP_URL=https://hospital.example.com

  - name: pgbouncer-config
    behavior: create
    literals:
      - POSTGRESQL_HOST=hospital-erp.xxxxxxxx.ap-northeast-2.rds.amazonaws.com

commonLabels:
  environment: production

images:
  - name: hospital-erp/backend
    newTag: stable
  - name: hospital-erp/frontend
    newTag: stable
