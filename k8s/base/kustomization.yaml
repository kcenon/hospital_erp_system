apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: hospital-erp-system

resources:
  - namespace.yaml
  - configs/backend-config.yaml
  - configs/frontend-config.yaml
  - external-secrets/service-account.yaml
  - external-secrets/cluster-secret-store.yaml
  - external-secrets/external-secret-database.yaml
  - external-secrets/external-secret-backend.yaml
  - external-secrets/external-secret-redis.yaml
  # Redis Cache
  - cache/redis-config.yaml
  - cache/redis-statefulset.yaml
  - cache/redis-service.yaml
  # Backend Application
  - backend/deployment.yaml
  - backend/service.yaml
  - backend/hpa.yaml
  - frontend/deployment.yaml
  - frontend/service.yaml
  - frontend/hpa.yaml
  # HorizontalPodAutoscaler (Auto-scaling)
  - database/pgbouncer-hpa.yaml
  - ingress/cluster-issuer.yaml
  - ingress/ingress.yaml
  # RBAC (Role-Based Access Control)
  - rbac/service-accounts.yaml
  - rbac/backend-role.yaml
  - rbac/frontend-role.yaml
  - rbac/role-bindings.yaml
  # Network Policies (Zero-Trust Security)
  - network-policies/default-deny.yaml
  - network-policies/allow-dns.yaml
  - network-policies/frontend-policy.yaml
  - network-policies/backend-policy.yaml
  - network-policies/database-policy.yaml
  - network-policies/redis-policy.yaml

labels:
  - pairs:
      app.kubernetes.io/part-of: hospital-erp-system
      app.kubernetes.io/managed-by: kustomize
    includeSelectors: true
    includeTemplates: true

images:
  - name: hospital-erp/backend
    newTag: latest
  - name: hospital-erp/frontend
    newTag: latest
